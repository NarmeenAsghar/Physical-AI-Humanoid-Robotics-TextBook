# Data Model: Textbook Content Generation

**Feature**: 002-textbook-content-generation
**Date**: 2025-11-29
**Purpose**: Define entities and relationships for textbook structure, lesson content, and research outlines

---

## Entity: Chapter

**Purpose**: Represents a major module/topic in the Physical AI course.

**Attributes**:
- `number`: Integer (1, 2, 3 for Phase 1)
- `title`: String (e.g., "The Robotic Nervous System (ROS 2)")
- `slug`: String, kebab-case (e.g., "ros2")
- `directory_path`: String (e.g., "docs/docs/chapter-02-ros2/")
- `category_config`: Object (label, position, collapsed, link)

**Relationships**:
- 1 Chapter → Many Lessons (1:N)

**Validation Rules**:
- `number` must be unique positive integer
- `slug` must be lowercase, alphanumeric + hyphens only
- `directory_path` must exist in filesystem
- `category_config.position` must match chapter number

**Source**: Parsed from COURSE_CONTENT.md "Module #:" headers

**Example**:
```json
{
  "number": 2,
  "title": "The Robotic Nervous System (ROS 2)",
  "slug": "ros2",
  "directory_path": "docs/docs/chapter-02-ros2/",
  "category_config": {
    "label": "Chapter 2: The Robotic Nervous System (ROS 2)",
    "position": 2,
    "collapsed": false,
    "link": {
      "type": "generated-index",
      "description": "Understanding ROS 2 middleware and core concepts"
    }
  }
}
```

---

## Entity: Lesson

**Purpose**: Represents a single learning unit within a chapter.

**Attributes**:
- `chapter_number`: Integer (foreign key to Chapter)
- `lesson_number`: Integer (1 or 2 for Phase 1)
- `title`: String (e.g., "Introduction to Embodied Intelligence")
- `slug`: String, kebab-case (e.g., "intro-embodied-intelligence")
- `file_path`: String (e.g., "docs/docs/chapter-01-foundations/lesson-01-intro-embodied-intelligence.md")
- `frontmatter`: Object (sidebar_position, title, description)
- `content_status`: Enum ("template", "full_content")
- `word_count`: Integer (0 for template, 700-900 for full content)
- `sections`: Array[7] of Section objects

**Relationships**:
- Many Lessons → 1 Chapter (N:1)
- 1 Lesson → 7 Sections (1:N, fixed count)
- 1 Lesson → 0 or 1 ResearchOutline (1:0..1, only for full content lessons)

**Validation Rules**:
- `lesson_number` must be 1 or 2 (Phase 1 constraint)
- `slug` must be unique within chapter
- `file_path` must exist and be valid markdown
- `frontmatter` must be valid YAML
- `sections` array must have exactly 7 elements in order
- If `content_status` = "full_content", `word_count` must be 700-900

**Source**: Generated by Lesson Template Generator skill, content filled by Technical Writer agent

**Example**:
```json
{
  "chapter_number": 1,
  "lesson_number": 1,
  "title": "Introduction to Embodied Intelligence",
  "slug": "intro-embodied-intelligence",
  "file_path": "docs/docs/chapter-01-foundations/lesson-01-intro-embodied-intelligence.md",
  "frontmatter": {
    "sidebar_position": 1,
    "title": "Introduction to Embodied Intelligence",
    "description": "Foundations of Physical AI and embodied intelligence principles"
  },
  "content_status": "full_content",
  "word_count": 823,
  "sections": [
    { "name": "Introduction", "word_count": 175 },
    { "name": "Learning Objectives", "word_count": 50 },
    { "name": "Key Concepts", "word_count": 330 },
    { "name": "Hands-on Exercise", "word_count": 140 },
    { "name": "Quiz", "word_count": 85 },
    { "name": "Key Takeaways", "word_count": 45 },
    { "name": "Further Reading", "word_count": 55 }
  ]
}
```

---

## Entity: Section

**Purpose**: Represents one of the 7 mandatory sections in a lesson.

**Attributes**:
- `name`: Enum ("Introduction", "Learning Objectives", "Key Concepts", "Hands-on Exercise", "Quiz", "Key Takeaways", "Further Reading")
- `heading_level`: Integer (always 2 for `##`)
- `content`: String (markdown text)
- `word_count`: Integer
- `subsections`: Array of Subsection objects (for Key Concepts only)

**Relationships**:
- Many Sections → 1 Lesson (N:1, exactly 7 per lesson)
- 1 Section → Many Subsections (1:N, only for Key Concepts section)

**Validation Rules**:
- `name` must be one of 7 allowed values (exact match)
- `heading_level` must be 2 (enforced by template)
- "Learning Objectives" content must use `- [ ]` checkbox format
- "Quiz" content must include `<details><summary>Show Answers</summary>` tag
- "Key Concepts" must have 3 subsections (### level 3 headings)
- "Further Reading" must include at least 2 HTTPS URLs

**Source**: Template provides structure, Technical Writer fills content

**Example - Key Concepts Section**:
```json
{
  "name": "Key Concepts",
  "heading_level": 2,
  "content": "## Key Concepts\n\n### What is Embodied Intelligence?\n\n...",
  "word_count": 330,
  "subsections": [
    {
      "name": "What is Embodied Intelligence?",
      "heading_level": 3,
      "word_count": 110,
      "has_callout": true
    },
    {
      "name": "The Sensor-Motor Integration Challenge",
      "heading_level": 3,
      "word_count": 110,
      "has_callout": true
    },
    {
      "name": "Physical World Constraints",
      "heading_level": 3,
      "word_count": 110,
      "has_callout": true
    }
  ]
}
```

---

## Entity: Subsection

**Purpose**: Represents a Key Concepts subsection (### level 3 heading).

**Attributes**:
- `name`: String (e.g., "What is Embodied Intelligence?")
- `heading_level`: Integer (always 3 for `###`)
- `word_count`: Integer (~100-120 words for full content)
- `has_callout`: Boolean (whether it includes a `>` blockquote callout box)

**Relationships**:
- Many Subsections → 1 Section (N:1, only for "Key Concepts" section)

**Validation Rules**:
- Must be child of "Key Concepts" section only
- Heading level must be 3
- For full content lessons, word count should be 100-120 words

**Source**: Technical Writer generates subsections during Key Concepts writing

---

## Entity: ResearchOutline

**Purpose**: Guides Technical Writer content generation for each full content lesson.

**Attributes**:
- `lesson_id`: String (e.g., "1.1", "2.1", "3.1")
- `key_concepts`: Array[3] of ConceptSummary objects
- `real_world_examples`: Array[2+] of Example objects
- `authoritative_sources`: Array[2-4] of Source objects
- `content_breakdown`: Object (word allocations per section)

**Relationships**:
- 1 ResearchOutline → 1 Lesson (1:1, only for full content lessons)

**Validation Rules**:
- `key_concepts` must have exactly 3 items
- `real_world_examples` must have minimum 2 items
- `authoritative_sources` must have 2-4 HTTPS URLs
- `content_breakdown` total words must equal ~800

**Source**: Generated during Phase 0 research, stored in research.md

**Example**:
```json
{
  "lesson_id": "1.1",
  "key_concepts": [
    {
      "title": "Embodied Intelligence Definition",
      "summary": "AI systems that operate in the physical world, integrating sensory input with motor control..."
    },
    {
      "title": "Sensor-Motor Integration",
      "summary": "The challenge of coordinating perception with action in real-time..."
    },
    {
      "title": "Physical World Constraints",
      "summary": "Limitations that don't exist in digital AI - power, safety, irreversibility..."
    }
  ],
  "real_world_examples": [
    {
      "name": "Tesla Optimus",
      "description": "Humanoid robot designed for manufacturing and domestic tasks...",
      "relevance": "Shows industrial commitment to embodied AI scaling"
    },
    {
      "name": "Figure 01 with GPT-4V",
      "description": "First humanoid with vision-language model integration...",
      "relevance": "Demonstrates language understanding combined with physical execution"
    }
  ],
  "authoritative_sources": [
    {
      "title": "OpenAI Embodied Intelligence Research (2024)",
      "url": "https://openai.com/research/physical-intelligence",
      "description": "Latest developments in AI for physical manipulation"
    },
    {
      "title": "Stanford HAI: Physical Intelligence Report",
      "url": "https://hai.stanford.edu/news/embodied-ai",
      "description": "Academic perspective on challenges and opportunities"
    }
  ],
  "content_breakdown": {
    "introduction": 175,
    "learning_objectives": 50,
    "key_concepts": 330,
    "hands_on_exercise": 140,
    "quiz": 85,
    "key_takeaways": 45,
    "further_reading": 55,
    "total": 880
  }
}
```

---

## Entity: ConceptSummary

**Purpose**: One of 3 key concepts identified during research for a lesson.

**Attributes**:
- `title`: String (e.g., "Embodied Intelligence Definition")
- `summary`: String (1-2 sentence explanation)

**Relationships**:
- Many ConceptSummary → 1 ResearchOutline (N:1, exactly 3 per outline)

**Source**: Research phase output (research.md)

---

## Entity: Example

**Purpose**: Real-world example to include in lesson content.

**Attributes**:
- `name`: String (e.g., "Tesla Optimus", "Unitree H1")
- `description`: String (what it is, what it does)
- `relevance`: String (why it matters for this lesson)

**Relationships**:
- Many Examples → 1 ResearchOutline (N:1, minimum 2 per outline)

**Source**: Research phase output (research.md)

---

## Entity: Source

**Purpose**: Authoritative external resource for Further Reading section.

**Attributes**:
- `title`: String (e.g., "OpenAI Embodied Intelligence Research")
- `url`: String (HTTPS URL, must be valid and accessible)
- `description`: String (brief explanation of what resource covers)

**Relationships**:
- Many Sources → 1 ResearchOutline (N:1, 2-4 per outline)

**Source**: Research phase output (research.md), Technical Writer adds to Further Reading section

**Validation Rules**:
- URL must start with `https://` (no http://)
- URL must be accessible (Technical Writer verifies during research)

---

## Entity Relationships Diagram

```
COURSE_CONTENT.md (input file)
    |
    | [Content Architect parses]
    v
  Module [1..4 defined]
    |
    | [maps 1:1 to]
    v
 Chapter [1..3 for Phase 1]
    |
    ├─> (has attribute) category_config
    |
    | [contains 1:N]
    v
 Lesson [1..2 per chapter = 6 total]
    |
    ├─> (has attribute) frontmatter
    ├─> (has attribute) content_status: "template" | "full_content"
    ├─> (has attribute) word_count
    |
    ├─> [has 1:N, exactly 7] Section
    |     |
    |     ├─> (has attribute) name: Enum[7 values]
    |     ├─> (has attribute) content: markdown string
    |     |
    |     └─> [has 0:N, only Key Concepts has 3] Subsection
    |           |
    |           ├─> (has attribute) name
    |           └─> (has attribute) has_callout: boolean
    |
    └─> [guided by 0:1, only full_content has] ResearchOutline
          |
          ├─> [has 1:N, exactly 3] ConceptSummary
          ├─> [has 1:N, minimum 2] Example
          ├─> [has 1:N, 2-4] Source
          └─> (has attribute) content_breakdown: word allocation

Workflow:
  Content Architect -> generates -> Chapter + Lesson (template status)
  Lesson Template Generator -> creates -> Lesson (7 Sections with placeholders)
  Research Phase -> produces -> ResearchOutline (for 3 priority lessons)
  Technical Writer -> uses ResearchOutline -> fills -> Lesson Sections (full_content status)
```

---

## State Transitions

### Lesson Content Status

```
[Template Created] (content_status: "template", word_count: ~200)
    |
    | [Technical Writer invoked]
    v
[Research Phase] (queries web, compiles outline)
    |
    | [Writing Phase]
    v
[Draft Content] (content_status: "full_content", word_count: 700-900)
    |
    | [Review Phase]
    v
[Validated Content] (word_count verified, objectives checked, URLs validated)
    |
    | [File Written]
    v
[Published Lesson] (file exists with full content, ready for Docusaurus build)
```

---

## Data Flow Summary

**Phase 1: Scaffolding**
1. Content Architect reads COURSE_CONTENT.md
2. Parses Modules → Creates Chapter entities (3 total)
3. For each Chapter, creates 2 Lesson entities (6 total)
4. Lesson Template Generator creates 7 Section entities per Lesson (42 total sections)
5. All Lessons start with `content_status: "template"`

**Phase 2: Research**
1. Research phase creates ResearchOutline for lessons 1.1, 2.1, 3.1
2. Each ResearchOutline contains 3 ConceptSummary, 2+ Examples, 2-4 Sources
3. Stored in research.md for Technical Writer reference

**Phase 3: Content Generation**
1. Technical Writer reads ResearchOutline for lesson 1.1
2. Fills Section content for all 7 sections using research
3. Updates Lesson: `content_status: "full_content"`, `word_count: ~800`
4. Repeats for lessons 2.1 and 3.1
5. Lessons 1.2, 2.2, 3.2 remain at `content_status: "template"`

**Final State**:
- 3 Chapters with category configs
- 6 Lessons: 3 with full_content (~800w each), 3 with template (~200w each)
- 42 Sections: 21 filled with researched content, 21 with placeholders
- Total content: ~2400 words (3 full lessons) + ~600 words (3 templates) = ~3000 words

---

**Data Model Complete**: Entities, relationships, validation rules, and state transitions defined for textbook content generation workflow.
